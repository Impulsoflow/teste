<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pesquisa Impulso DISC</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
  <script type="text/javascript">
    (function () {
      // üîë Substitua pela sua chave p√∫blica do EmailJS
      emailjs.init("SUA_CHAVE_PUBLICA_EMAILJS"); // Substitua por sua chave p√∫blica real
    })();
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    body {
      background: linear-gradient(135deg, #a5f3fc, #06b6d4);
      font-family: 'Inter', sans-serif;
    }
    .scale-option {
      transition: all 0.2s ease;
      border: 2px solid #cbd5e1;
      border-radius: 8px;
      padding: 8px;
      text-align: center;
      cursor: pointer;
      background-color: #f8fafc;
      font-weight: 600;
    }
    .scale-option:hover {
      background-color: #e0f2fe;
      border-color: #38bdf8;
    }
    .scale-option:active {
      transform: scale(1.1);
    }
    .scale-option.selected {
      background: linear-gradient(135deg, #3b82f6, #1e40af);
      color: white;
      border-color: #1e40af;
    }
    .bar-3d {
      position: relative;
      height: 30px;
      width: 80px;
      border-radius: 0 8px 8px 0;
      box-shadow: 8px 0 15px rgba(0,0,0,0.15), inset -3px 0 8px rgba(0,0,0,0.1);
      transition: width 1.2s cubic-bezier(0.2, 0.8, 0.4, 1);
    }
    .bar-value {
      position: absolute;
      right: -30px;
      top: 50%;
      transform: translateY(-50%);
      color: white;
      font-weight: 700;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
      font-size: 0.9em;
      background: rgba(0,0,0,0.65);
      padding: 2px 8px;
      border-radius: 15px;
    }
    .btn-primary { background: linear-gradient(135deg, #3b82f6, #1e40af); transition: transform 0.1s ease; }
    .btn-primary:active { transform: scale(1.1); }
    .btn-secondary { background: linear-gradient(135deg, #6b7280, #4b5563); }
    .btn-result { background: linear-gradient(135deg, #ec4899, #be185d); transition: transform 0.1s ease; }
    .btn-result:active { transform: scale(1.1); }
    .btn-start { background: linear-gradient(135deg, #22d3ee, #0ea5e9); }
    .signature { font-family: 'Dancing Script', cursive; color: #0ea5e9; font-size: 1.4rem; }
    .alert-blink {
      animation: blink 1.2s infinite;
      background: linear-gradient(135deg, #dbeafe, #bfdbfe);
      border-left: 4px solid #3b82f6;
      padding: 10px;
      border-radius: 8px;
      margin-top: 10px;
      font-weight: 600;
      color: #1e40af;
    }
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }
    .input-icon { position: relative; }
    .input-icon svg {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      width: 20px;
      height: 20px;
      color: #4b5563;
    }
    .input-icon input { padding-left: 40px; }
    .progress-bar {
      height: 8px;
      background: #e5e7eb;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 12px;
    }
    .progress-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6, #0ea5e9);
      transition: width 0.3s ease;
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
  <div class="max-w-3xl w-full bg-white rounded-2xl shadow-xl p-6 md:p-8">
    <h2 class="text-3xl md:text-4xl font-bold text-center text-transparent bg-clip-text bg-gradient-to-r from-teal-500 to-blue-600 mb-2">Impulso Coaching</h2>
    <h1 class="text-4xl md:text-5xl font-extrabold text-center text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-teal-500 mb-4">Pesquisa Impulso DISC</h1>
    <p class="text-center text-gray-600 mb-6">A Mudan√ßa Pode Acontecer Em Um Instante</p>

    <div id="intro">
      <div class="bg-gradient-to-r from-blue-100 to-teal-100 p-5 rounded-lg mb-4 shadow-md">
        <p class="text-lg font-semibold text-gray-800 mb-3">Dados Pessoais</p>
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 mb-3">
          <div class="input-icon">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
            </svg>
            <input type="text" id="name" placeholder="Nome *" class="border border-teal-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-teal-500 bg-gradient-to-r from-white to-teal-50" />
          </div>
          <div class="input-icon">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
            </svg>
            <input type="number" id="age" placeholder="Idade *" class="border border-teal-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-teal-500 bg-gradient-to-r from-white to-teal-50" />
          </div>
          <div class="input-icon">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
            </svg>
            <input type="text" id="occupation" placeholder="Profiss√£o" class="border border-teal-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-teal-500 bg-gradient-to-r from-white to-teal-50" />
          </div>
        </div>
        <div class="input-icon">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
          </svg>
          <input type="email" id="email" placeholder="Email *" class="border border-teal-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-teal-500 bg-gradient-to-r from-white to-teal-50" />
        </div>
        <div class="flex justify-end mt-3">
          <button onclick="startTest()" class="btn-start text-white px-5 py-2 rounded-lg transition shadow-md text-sm md:text-base">Iniciar Pesquisa</button>
        </div>
      </div>

      <div class="alert-blink text-center text-sm md:text-base">
        <p class="font-bold">Dicas para Responder</p>
        <ul class="list-disc list-inside mt-1 space-y-1">
          <li>Seja honesto: responda como voc√™ realmente √©.</li>
          <li>Pense em situa√ß√µes do seu cotidiano.</li>
          <li>Escolha a afirma√ß√£o que melhor te descreve.</li>
          <li>N√£o h√° respostas certas ou erradas!</li>
        </ul>
      </div>
    </div>

    <div id="test-section" class="hidden">
      <div id="current-question"></div>
    </div>

    <div id="result" class="hidden mt-4">
      <div class="bg-gradient-to-r from-blue-50 to-teal-50 p-4 rounded-lg shadow-md mb-4">
        <h2 class="text-2xl font-extrabold text-center text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-teal-500 mb-2">Pesquisa Impulso DISC</h2>
        <p class="text-center text-gray-700 text-sm mb-2" id="personal-data"></p>
        <p class="text-center text-gray-700 text-sm">Explore como suas caracter√≠sticas se distribuem nas quatro dimens√µes do DISC e descubra seus pontos fortes e √°reas de melhoria.</p>
      </div>

      <div id="scores" class="flex flex-col space-y-4 mb-6 bg-gray-50 rounded-lg p-4">
        <div class="flex items-center">
          <div class="font-bold text-red-600 text-sm mr-4 w-24">Domin√¢ncia<br><span class="text-xs">Fogo / Col√©rico</span></div>
          <div class="bar-3d score-d" id="bar-dominancia" style="width: 0px"><div class="bar-value" id="val-dominancia">0%</div></div>
        </div>
        <div class="flex items-center">
          <div class="font-bold text-orange-600 text-sm mr-4 w-24">Influ√™ncia<br><span class="text-xs">Ar / Sangu√≠neo</span></div>
          <div class="bar-3d score-i" id="bar-influencia" style="width: 0px"><div class="bar-value" id="val-influencia">0%</div></div>
        </div>
        <div class="flex items-center">
          <div class="font-bold text-blue-600 text-sm mr-4 w-24">Estabilidade<br><span class="text-xs">√Ågua / Fleum√°tico</span></div>
          <div class="bar-3d score-s" id="bar-estabilidade" style="width: 0px"><div class="bar-value" id="val-estabilidade">0%</div></div>
        </div>
        <div class="flex items-center">
          <div class="font-bold text-green-600 text-sm mr-4 w-24">Conformidade<br><span class="text-xs">Terra / Melanc√≥lico</span></div>
          <div class="bar-3d score-c" id="bar-conformidade" style="width: 0px"><div class="bar-value" id="val-conformidade">0%</div></div>
        </div>
      </div>

      <div id="dominant-section" class="mt-4 space-y-3"></div>

      <div id="disc-explanation" class="bg-gradient-to-r from-blue-100 to-teal-100 p-4 rounded-lg mt-4 shadow-md">
        <p class="text-lg font-semibold text-gray-800 mb-2">O que √© o DISC?</p>
        <p class="text-gray-700 text-xs">
          O DISC¬Æ √© uma metodologia de avalia√ß√£o comportamental desenvolvida com base nos estudos de William Marston...
        </p>
      </div>
      <p class="text-right mt-4 text-xl signature">Rog√©rio Braga - impulsoflow@gmail.com</p>
    </div>
  </div>

  <script>
    // === CONFIGURA√á√ÉO DO EMAILJS ===
    const EMAILJS_SERVICE_ID = "SUA_SERVICE_ID"; // Substitua pelo seu Service ID do EmailJS
    const EMAILJS_TEMPLATE_ID = "SUA_TEMPLATE_ID"; // Substitua pelo seu Template ID do EmailJS

    // === AFIRMA√á√ïES CORRIGIDAS POR PERFIL ===
    const affirmations = [
      // Bloco 1
      "Enfrento desafios de frente e tomo decis√µes r√°pidas.", // D
      "Adoro conhecer pessoas novas e criar conex√µes.", // I
      "Prefiro um ambiente calmo e previs√≠vel, onde todos se apoiam.", // S
      "Reviso tudo com cuidado para garantir que esteja 100% correto.", // C
      // Bloco 2
      "Sou direto e focado em resultados, mesmo que isso gere conflito.", // D
      "Meu entusiasmo √© contagiante e motiva os outros a agir.", // I
      "Sou paciente e um bom ouvinte, especialmente em momentos dif√≠ceis.", // S
      "Sigo regras e procedimentos com rigor e consist√™ncia.", // C
      // Bloco 3
      "Assumo riscos calculados para atingir objetivos ambiciosos.", // D
      "Gosto de ser o centro das aten√ß√µes e receber reconhecimento.", // I
      "Valorizo a harmonia e evito conflitos sempre que poss√≠vel.", // S
      "Minhas decis√µes s√£o baseadas em dados, fatos e an√°lise l√≥gica.", // C
      // Bloco 4
      "Sou competitivo e orientado para vencer.", // D
      "Sou carism√°tico, falante e animado em qualquer ambiente.", // I
      "Sou leal √†s pessoas e √†s causas em que acredito.", // S
      "Sou organizado, sistem√°tico e orientado para detalhes.", // C
      // Bloco 5
      "Questiono o 'status quo' e busco maneiras mais eficientes.", // D
      "Confio na minha intui√ß√£o e no meu 'feeling' sobre as pessoas.", // I
      "Gosto de oferecer apoio pr√°tico e ajudar nos bastidores.", // S
      "Preciso de explica√ß√µes claras e de um motivo l√≥gico para mudan√ßas.", // C
      // Bloco 6
      "Sob press√£o, assumo o comando e sou assertivo.", // D
      "Uso o humor e a criatividade para aliviar tens√µes.", // I
      "Internalizo o estresse para evitar conflitos abertos.", // S
      "Sob press√£o, me retrai e foco nos dados para encontrar solu√ß√µes.", // C
      // Bloco 7
      "Busco autoridade e autonomia no meu ambiente.", // D
      "Gosto de motivar e inspirar os outros a agir.", // I
      "Preciso de tempo para me adaptar a mudan√ßas significativas.", // S
      "Posso ser cr√≠tico quando os padr√µes de qualidade n√£o s√£o atendidos.", // C
      // Bloco 8
      "Impaci√™ncia √© um desafio para mim, especialmente com indecis√£o.", // D
      "Temo a rejei√ß√£o social e me esfor√ßo para ser querido.", // I
      "Valorizo a sinceridade e a confian√ßa acima de tudo.", // S
      "Temo cometer erros e ser pego despreparado.", // C
      // Bloco 9
      "Prefiro variedade e a√ß√£o a rotinas est√°veis.", // D
      "Sou descrito como otimista e cheio de ideias.", // I
      "Prefiro seguir m√©todos comprovados a experimentar o novo.", // S
      "Minha comunica√ß√£o √© formal, precisa e baseada em l√≥gica.", // C
      // Bloco 10
      "Foco no resultado final, mesmo que negligencie detalhes.", // D
      "Tenho facilidade em usar entusiasmo para persuadir os outros.", // I
      "Sou diplom√°tico e evito confrontos desnecess√°rios.", // S
      "Sigo padr√µes estabelecidos para garantir qualidade.", // C
      // Bloco 11
      "Decido r√°pido e com confian√ßa, mesmo em momentos de press√£o.", // D
      "Me energizo ao interagir e colaborar com pessoas.", // I
      "Sou met√≥dico e prefiro concluir uma tarefa antes de iniciar outra.", // S
      "Sou naturalmente organizado e orientado para detalhes.", // C
      // Bloco 12
      "Encaro problemas de cabe√ßa erguida, sem recuar.", // D
      "Trago humor e crio um clima positivo ao meu redor.", // I
      "Colaboro com colegas, mesmo em pontos de discord√¢ncia.", // S
      "Baseio minhas escolhas em an√°lises de dados claras.", // C
    ];

    let current = 0;
    const responses = new Array(48).fill(null);

    function sanitize(str) {
      return str.replace(/[<>&"']/g, char => ({ '<': '<', '>': '>', '&': '&amp;', '"': '&quot;', "'": '&#39;' }[char]));
    }

    function validateEmail(email) {
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }

    function startTest() {
      const name = document.getElementById('name').value.trim();
      const age = document.getElementById('age').value.trim();
      const email = document.getElementById('email').value.trim();
      if (!name || !age || !email || !validateEmail(email)) {
        alert('Preencha todos os campos corretamente.');
        return;
      }
      document.getElementById('intro').classList.add('hidden');
      document.getElementById('test-section').classList.remove('hidden');
      loadQuestion(0);
    }

    function loadQuestion(index) {
      current = index;
      const qNum = index + 1;
      const progress = Math.round(((qNum - 1) / 48) * 100);
      const html = `
        <div class="bg-gradient-to-r from-blue-50 to-teal-50 p-5 rounded-lg shadow-md">
          <p class="text-lg font-semibold text-gray-800 mb-4">Pergunta ${String(qNum).padStart(2, '0')} de 48</p>
          <p class="text-2xl font-bold text-center mb-6">"${affirmations[index]}"</p>
          <div class="grid grid-cols-5 gap-2 mb-6">
            ${[1,2,3,4,5].map(val => `
              <div class="scale-option" data-value="${val}" onclick="selectAnswer(${qNum}, ${val})">
                ${val}<br><small>${val === 1 ? 'Discordo totalmente' : val === 2 ? 'Discordo' : val === 3 ? 'Neutro' : val === 4 ? 'Concordo' : 'Concordo totalmente'}</small>
              </div>
            `).join('')}
          </div>
          <div class="flex flex-col items-center">
            ${index < 47 ? 
              `<button onclick="nextQuestion(${index})" class="btn-primary text-white px-6 py-3 rounded-lg text-base ${responses[index] === null ? 'opacity-50 cursor-not-allowed' : ''}">Pr√≥xima</button>` :
              `<button onclick="showResult()" class="btn-result text-white px-6 py-3 rounded-lg text-base ${responses[index] === null ? 'opacity-50 cursor-not-allowed' : ''}">Ver Resultado</button>`
            }
            ${index > 0 ? `<button onclick="loadQuestion(${index - 1})" class="btn-secondary text-white px-4 py-2 rounded-lg text-sm mt-2">Anterior</button>` : ``}
          </div>
          <div class="progress-bar">
            <div class="progress-bar-fill" style="width: ${progress}%"></div>
          </div>
        </div>
        <input type="hidden" id="q${qNum}" value="${responses[index] || ''}">
      `;
      document.getElementById('current-question').innerHTML = html;
      if (responses[index] !== null) {
        document.querySelector(`.scale-option[data-value="${responses[index]}"]`).classList.add('selected');
      }
    }

    function selectAnswer(qNum, value) {
      responses[qNum - 1] = value;
      document.querySelectorAll('.scale-option').forEach(el => el.classList.remove('selected'));
      document.querySelector(`.scale-option[data-value="${value}"]`).classList.add('selected');
      document.getElementById(`q${qNum}`).value = value;
    }

    function nextQuestion(index) {
      if (responses[index] === null) {
        alert('Selecione uma op√ß√£o antes de continuar.');
        return;
      }
      loadQuestion(index + 1);
    }

    // === EXPLICA√á√ÉO DETALHADA DO DISC ===
    const discExplanationFull = `O DISC¬Æ √© uma metodologia de avalia√ß√£o comportamental desenvolvida com base nos estudos do psic√≥logo William Moulton Marston na d√©cada de 1920. A ferramenta categoriza os comportamentos humanos em quatro dimens√µes principais:

- Domin√¢ncia (D): Como a pessoa lida com desafios e problemas.
- Influ√™ncia (I): Como a pessoa interage com outras pessoas e influencia.
- Estabilidade (S): Como a pessoa responde a mudan√ßas e ritmo.
- Conformidade (C): Como a pessoa segue regras, procedimentos e padr√µes.

O DISC n√£o mede intelig√™ncia, valores ou habilidades t√©cnicas, mas sim tend√™ncias comportamentais naturais. √â amplamente utilizado em:
‚Ä¢ Desenvolvimento de lideran√ßa
‚Ä¢ Forma√ß√£o de equipes
‚Ä¢ Recrutamento e sele√ß√£o
‚Ä¢ Coaching individual
‚Ä¢ Resolu√ß√£o de conflitos

Mais de 53 milh√µes de pessoas j√° utilizaram o DISC em mais de 38 anos de aplica√ß√£o global.`;

    // === PERFIS COMPLETOS ===
    const fullProfiles = {
      D: {
        name: "Domin√¢ncia (Col√©rico)",
        desc: "Indiv√≠duos com perfil Dominante s√£o movidos por desafios, resultados e controle. S√£o l√≠deres naturais que tomam decis√µes r√°pidas, enfrentam obst√°culos com coragem e preferem ambientes onde podem agir com autonomia. T√™m foco intenso em metas e n√£o se intimidam diante de conflitos ou press√£o. No ambiente profissional, destacam-se em pap√©is que exigem iniciativa, coragem e capacidade de resolver problemas complexos sob estresse.",
        qualities: "Coragem para tomar decis√µes dif√≠ceis, iniciativa para agir sem esperar instru√ß√µes, foco implac√°vel em resultados, assertividade na comunica√ß√£o, lideran√ßa por exemplo, resili√™ncia sob press√£o, capacidade de assumir riscos calculados, energia para impulsionar mudan√ßas, objetividade ao cortar caminho, persist√™ncia diante de obst√°culos.",
        weaknesses: "Impaci√™ncia com processos lentos ou burocr√°ticos, tend√™ncia a ser autorit√°rio ou insens√≠vel √†s emo√ß√µes alheias, dificuldade em delegar tarefas por medo de perda de controle, neglig√™ncia de detalhes em prol da velocidade, rea√ß√£o defensiva a cr√≠ticas, dificuldade em ouvir opini√µes contr√°rias, tend√™ncia a criar conflitos desnecess√°rios por impulso, frustra√ß√£o com indecis√£o alheia, foco excessivo em metas a ponto de ignorar rela√ß√µes interpessoais, resist√™ncia a feedbacks que questionem sua autoridade.",
        development: "Pratique escuta ativa: pare, olhe nos olhos e ou√ßa sem interromper. Desenvolva empatia: pergunte como os outros se sentem antes de agir. Aprenda a delegar com confian√ßa: defina claramente o resultado esperado, mas permita liberdade no caminho. Respire antes de reagir sob press√£o. Busque feedback regularmente, especialmente de pessoas que pensam diferente. Lembre-se: resultados sustent√°veis nascem de equipes engajadas, n√£o apenas de decis√µes r√°pidas.",
        color: "#ef4444"
      },
      I: {
        name: "Influ√™ncia (Sangu√≠neo)",
        desc: "Pessoas com perfil Influente s√£o extrovertidas, entusiasmadas e naturalmente persuasivas. Energizam-se com intera√ß√£o social, criam conex√µes com facilidade e usam seu carisma para motivar os outros. S√£o otimistas, criativas e adoram compartilhar ideias. No trabalho, brilham em fun√ß√µes que envolvem comunica√ß√£o, vendas, ensino ou qualquer atividade que exija engajar pessoas. Sua maior for√ßa √© a capacidade de inspirar e criar ambientes positivos, mesmo em momentos dif√≠ceis.",
        qualities: "Carisma e presen√ßa marcante, habilidade de comunica√ß√£o verbal e n√£o verbal, otimismo contagiante, criatividade para gerar ideias, entusiasmo que motiva equipes, facilidade em construir relacionamentos, capacidade de vender ideias ou produtos, flexibilidade para se adaptar a novos contextos, senso de humor que alivia tens√µes, energia para iniciar projetos com paix√£o.",
        weaknesses: "Desorganiza√ß√£o e procrastina√ß√£o em tarefas rotineiras, impulsividade ao tomar decis√µes sem analisar dados, dificuldade em manter foco em atividades anal√≠ticas ou de longo prazo, tend√™ncia a prometer mais do que pode entregar, sensibilidade excessiva √† rejei√ß√£o ou cr√≠ticas, evita√ß√£o de conflitos dif√≠ceis por medo de perder popularidade, distra√ß√£o f√°cil com novidades, dificuldade em cumprir prazos sem supervis√£o, foco excessivo em aprova√ß√£o externa, neglig√™ncia de detalhes t√©cnicos importantes.",
        development: "Desenvolva disciplina: use agendas, listas de tarefas e lembretes. Pratique foco: defina blocos de tempo para tarefas anal√≠ticas sem distra√ß√µes. Aceite feedbacks cr√≠ticos como oportunidades de crescimento, n√£o como ataques pessoais. Cumpra promessas: subestime sua capacidade ao comprometer-se. Equilibre entusiasmo com planejamento: antes de agir, pergunte 'quais dados apoiam esta ideia?'.",
        color: "#f59e0b"
      },
      S: {
        name: "Estabilidade (Fleum√°tico)",
        desc: "Indiv√≠duos com perfil Est√°vel s√£o pacientes, leais e profundamente colaborativos. Valorizam a harmonia, a confian√ßa e a estabilidade em seus relacionamentos e ambientes de trabalho. S√£o ouvintes atentos, oferecem apoio constante e evitam conflitos sempre que poss√≠vel. Preferem rotinas previs√≠veis e mudan√ßas graduais. Sua for√ßa est√° na capacidade de criar ambientes seguros, onde todos se sentem acolhidos e respeitados. S√£o a 'cola' que mant√©m equipes unidas em tempos de crise.",
        qualities: "Paci√™ncia excepcional em situa√ß√µes de tens√£o, lealdade inabal√°vel a pessoas e causas, empatia genu√≠na para compreender sentimentos alheias, trabalho em equipe com foco no coletivo, escuta ativa sem julgamento, confiabilidade para cumprir compromissos, calma sob press√£o que acalma os outros, consist√™ncia no desempenho, diplomacia para mediar conflitos, apoio pr√°tico e discreto.",
        weaknesses: "Resist√™ncia a mudan√ßas repentinas ou radicais, passividade que evita confrontar problemas, dificuldade em dizer 'n√£o' por medo de desagradar, lentid√£o em tomar decis√µes por medo de errar, tend√™ncia a suprimir pr√≥prias opini√µes para manter a paz, dificuldade em lidar com ambientes ca√≥ticos ou competitivos, frustra√ß√£o com colegas impulsivos ou agressivos, evita√ß√£o de riscos mesmo quando necess√°rios, dificuldade em se promover ou destacar conquistas, sobrecarga emocional por absorver tens√µes alheias.",
        development: "Pratique assertividade: expresse suas ideias com clareza e respeito. Defina limites saud√°veis: aprender a dizer 'n√£o' √© um ato de autocuidado. Aceite mudan√ßas como oportunidades: comece com pequenos ajustes. Expresse suas necessidades: sua voz √© t√£o importante quanto a dos outros. Busque feedback sobre seu impacto: voc√™ pode estar mais influente do que imagina.",
        color: "#3b82f6"
      },
      C: {
        name: "Conformidade (Melanc√≥lico)",
        desc: "Pessoas com perfil Conformista s√£o anal√≠ticas, precisas e orientadas por dados e processos. Valorizam a qualidade, a l√≥gica e a consist√™ncia acima de tudo. S√£o meticulosas, organizadas e focadas em fazer as coisas 'da maneira certa'. No trabalho, excelentes em fun√ß√µes que exigem aten√ß√£o a detalhes, an√°lise de riscos, controle de qualidade ou resolu√ß√£o de problemas complexos. Sua for√ßa √© garantir que nada passe despercebido e que os padr√µes sejam mantidos.",
        qualities: "Precis√£o e aten√ß√£o a detalhes minuciosos, pensamento l√≥gico e anal√≠tico, organiza√ß√£o sistem√°tica de informa√ß√µes, integridade para seguir regras e padr√µes, consist√™ncia no desempenho, capacidade de identificar erros ou inconsist√™ncias, foco em qualidade e excel√™ncia, paci√™ncia para revisar e refinar, objetividade baseada em fatos, disciplina para seguir processos.",
        weaknesses: "Perfeccionismo excessivo que atrasa entregas, cr√≠tica excessiva (consigo e com os outros) por padr√µes elevados, hesita√ß√£o em decidir sem todas as informa√ß√µes, rigidez em seguir processos mesmo quando ineficazes, dificuldade em lidar com imprevistos ou ambiguidades, tend√™ncia a isolar-se para focar no trabalho, resist√™ncia a feedbacks subjetivos ou emocionais, lentid√£o em adaptar-se a mudan√ßas de √∫ltima hora, foco excessivo em problemas em vez de solu√ß√µes, dificuldade em delegar por medo de perda de controle de qualidade.",
        development: "Aceite riscos calculados: nem toda decis√£o precisa de 100% de certeza. Pratique flexibilidade: pergunte 'qual √© o custo de esperar mais?'. Celebre progressos, n√£o s√≥ a perfei√ß√£o. Confie mais na intui√ß√£o e na experi√™ncia alheia. Comunique suas an√°lises de forma construtiva, n√£o cr√≠tica. Lembre-se: velocidade e adapta√ß√£o s√£o t√£o valiosas quanto precis√£o em muitos contextos.",
        color: "#10b981"
      }
    };

    // === 20 PROFISS√ïES POR PERFIL ===
    const professions = {
      D: [
        "Empreendedor / Fundador de Startups",
        "CEO / Diretor Executivo",
        "Advogado de Lit√≠gios",
        "Corretor de Im√≥veis de Alto Padr√£o",
        "Trader / Investidor",
        "Policial / Agente de Seguran√ßa",
        "Engenheiro de Projetos (com lideran√ßa)",
        "Gerente de Vendas",
        "Piloto de Competi√ß√£o / Esportes Radicais",
        "Consultor de Transforma√ß√£o Organizacional",
        "Militar de Alta Patente",
        "Produtor de Eventos de Alto Impacto",
        "Chef Executivo",
        "Diretor de Opera√ß√µes",
        "Engenheiro de Minas",
        "Corretor de Seguros Corporativos",
        "Gerente de Crise",
        "Inspetor de Qualidade Industrial",
        "Comandante de Navio",
        "L√≠der de Equipe de Resgate"
      ],
      I: [
        "Vendedor / Account Executive",
        "Apresentador de TV / R√°dio",
        "Influenciador Digital",
        "Professor (Educa√ß√£o Infantil ou Ensino M√©dio)",
        "Recrutador de Talentos",
        "Rela√ß√µes P√∫blicas",
        "Ator / Performer",
        "Palestrante Motivacional",
        "Host de Eventos",
        "Gerente de Marketing de Influ√™ncia",
        "M√∫sico",
        "Instrumentista",
        "Compositor",
        "Cantor / Artista Perform√°tico",
        "DJ / Produtor Musical",
        "Designer de Moda",
        "Criador de Conte√∫do",
        "Coach de Vida",
        "Guia de Turismo",
        "Animador Cultural"
      ],
      S: [
        "Enfermeiro / T√©cnico em Enfermagem",
        "Assistente Social",
        "Coordenador de Equipe (RH ou Opera√ß√µes)",
        "Professor de Educa√ß√£o Especial",
        "Terapeuta Ocupacional",
        "Bibliotec√°rio",
        "Mediador de Conflitos",
        "Analista de Suporte ao Cliente",
        "Cuidador de Idosos",
        "Facilitador de Grupos Terap√™uticos",
        "Conselheiro Pastoral",
        "Psic√≥logo Cl√≠nico",
        "Instrutor de Yoga / Medita√ß√£o",
        "Coordenador de Voluntariado",
        "Assistente Administrativo S√™nior",
        "T√©cnico em Laborat√≥rio Cl√≠nico",
        "Conselheiro Escolar",
        "Coordenador de Projetos Sociais",
        "Auxiliar de Biblioteca",
        "Cuidador de Crian√ßas"
      ],
      C: [
        "Cientista de Dados",
        "Auditor Fiscal / Contador Forense",
        "Engenheiro de Qualidade",
        "Programador / Desenvolvedor de Software",
        "Farmac√™utico",
        "Analista de Riscos Financeiros",
        "Perito Criminal",
        "Estat√≠stico",
        "Arquiteto de Sistemas",
        "Pesquisador Acad√™mico",
        "Contador Forense",
        "Engenheiro Aeroespacial",
        "Bioestat√≠stico",
        "Especialista em Ciberseguran√ßa",
        "Analista de Compliance",
        "Engenheiro de Software",
        "Analista de Dados Financeiros",
        "Perito Cont√°bil",
        "Especialista em Automa√ß√£o Industrial",
        "Analista de Sistemas ERP"
      ]
    };

    // === EXPLICA√á√ÉO DA COMBINA√á√ÉO (20+ LINHAS) ===
    function getCombinationExplanation(primary, secondary) {
      const combos = {
        DI: `Sua combina√ß√£o Domin√¢ncia-Influ√™ncia (DI) cria um perfil din√¢mico e orientado para a√ß√£o. Voc√™ √© naturalmente persuasivo, competitivo e adora desafios. Seu estilo √© r√°pido, entusiasmado e focado em resultados. No ambiente profissional, voc√™ se destaca em vendas, lideran√ßa de equipes ou empreendedorismo, onde pode usar sua energia para motivar outros e conquistar metas ambiciosas. Seus maiores desafios incluem a impaci√™ncia com processos lentos e a tend√™ncia a negligenciar detalhes em prol da velocidade. Para crescer, pratique escuta ativa e desenvolva paci√™ncia com colegas mais anal√≠ticos ou cautelosos. Seu superpoder √© transformar ideias em realidade com carisma e determina√ß√£o.`,
        DS: `A combina√ß√£o Domin√¢ncia-Estabilidade (DS) equilibra a√ß√£o e apoio. Voc√™ √© um l√≠der pr√°tico, confi√°vel e orientado para solu√ß√µes duradouras. Prefere ambientes est√°veis onde pode implementar mudan√ßas de forma controlada. Sua for√ßa est√° em construir equipes leais e resolver problemas com calma e efici√™ncia. Evite frustrar-se com colegas impulsivos ou indecisos; em vez disso, use sua paci√™ncia para guiar o grupo. Seu desafio √© equilibrar sua necessidade de controle com a flexibilidade necess√°ria em ambientes din√¢micos. Voc√™ prospera em pap√©is como gerente de opera√ß√µes, engenheiro de projetos ou coordenador de equipes t√©cnicas.`,
        DC: `Domin√¢ncia-Conformidade (DC) forma um perfil anal√≠tico e decisivo. Voc√™ toma decis√µes baseadas em dados, mas age com rapidez quando necess√°rio. Sua precis√£o e foco em qualidade o tornam ideal para pap√©is t√©cnicos de lideran√ßa, como engenheiro-chefe, auditor s√™nior ou consultor estrat√©gico. Seu maior desafio √© evitar o perfeccionismo que atrasa entregas. Aprenda a delegar tarefas anal√≠ticas e confie na intui√ß√£o quando os dados forem insuficientes. Seu superpoder √© resolver problemas complexos com l√≥gica implac√°vel e execu√ß√£o eficiente.`,
        ID: `Influ√™ncia-Domin√¢ncia (ID) √© a combina√ß√£o do carisma com a a√ß√£o. Voc√™ √© um vision√°rio entusiasmado que inspira outros a agir. Excelente em pap√©is de vendas, marketing ou lideran√ßa criativa, onde pode usar sua energia para conquistar e motivar. Cuidado com a impulsividade e a tend√™ncia a prometer mais do que pode entregar. Desenvolva disciplina e use sua influ√™ncia para construir parcerias duradouras, n√£o apenas conquistas r√°pidas. Seu superpoder √© transformar vis√µes em movimento coletivo.`,
        IS: `Influ√™ncia-Estabilidade (IS) cria um perfil acolhedor e colaborativo. Voc√™ √© um facilitador natural, que constr√≥i relacionamentos s√≥lidos e ambientes positivos. Ideal para recursos humanos, ensino ou atendimento ao cliente, onde sua empatia e entusiasmo brilham. Seu desafio √© evitar a passividade diante de conflitos; pratique assertividade para expressar suas ideias com clareza. Seu superpoder √© criar harmonia em equipes diversas, transformando tens√µes em coopera√ß√£o.`,
        IC: `Influ√™ncia-Conformidade (IC) equilibra criatividade e precis√£o. Voc√™ comunica ideias com clareza e aten√ß√£o aos detalhes. Excelente em pap√©is como designer instrucional, redator t√©cnico ou gerente de produto, onde pode traduzir conceitos complexos em mensagens acess√≠veis. Cuidado com a autocr√≠tica excessiva; celebre suas conquistas criativas. Seu superpoder √© fazer com que dados e ideias ganhem vida de forma envolvente e precisa.`,
        SD: `Estabilidade-Domin√¢ncia (SD) forma um l√≠der de apoio pr√°tico. Voc√™ √© leal, paciente e orientado para solu√ß√µes concretas. Ideal para gest√£o de equipes operacionais, log√≠stica ou suporte t√©cnico, onde sua confiabilidade √© essencial. Seu desafio √© assumir riscos calculados; saia da zona de conforto para liderar mudan√ßas. Seu superpoder √© manter a estabilidade enquanto impulsiona melhorias graduais e sustent√°veis.`,
        SI: `Estabilidade-Influ√™ncia (SI) √© a combina√ß√£o da harmonia com o entusiasmo. Voc√™ √© um mediador carism√°tico, que constr√≥i pontes entre pessoas. Excelente em fun√ß√µes de suporte, voluntariado ou coordena√ß√£o de eventos, onde sua empatia e energia criam conex√µes. Cuidado com a dificuldade em dizer "n√£o"; defina limites saud√°veis. Seu superpoder √© transformar grupos em comunidades coesas e motivadas.`,
        SC: `Estabilidade-Conformidade (SC) cria um perfil meticuloso e confi√°vel. Voc√™ √© o alicerce de qualquer equipe, garantindo precis√£o e consist√™ncia. Ideal para contabilidade, an√°lise de dados ou suporte administrativo, onde sua aten√ß√£o aos detalhes √© crucial. Seu desafio √© adaptar-se a mudan√ßas repentinas; pratique flexibilidade gradual. Seu superpoder √© manter a qualidade e a confian√ßa em processos cr√≠ticos.`,
        CD: `Conformidade-Domin√¢ncia (CD) forma um estrategista anal√≠tico. Voc√™ planeja com precis√£o e executa com determina√ß√£o. Excelente em pap√©is como cientista de dados, engenheiro de sistemas ou consultor de riscos, onde sua l√≥gica e foco em resultados s√£o essenciais. Cuidado com a rigidez; aceite que nem toda decis√£o precisa de 100% de certeza. Seu superpoder √© transformar dados em estrat√©gias vencedoras.`,
        CI: `Conformidade-Influ√™ncia (CI) equilibra an√°lise e comunica√ß√£o. Voc√™ traduz dados complexos em insights acess√≠veis. Ideal para an√°lise de mercado, ensino t√©cnico ou consultoria, onde sua clareza e precis√£o educam e influenciam. Seu desafio √© evitar a sobrecarga por perfeccionismo; priorize progresso sobre perfei√ß√£o. Seu superpoder √© fazer com que a l√≥gica inspire a√ß√£o.`,
        CS: `Conformidade-Estabilidade (CS) cria um perfil detalhista e colaborativo. Voc√™ √© o guardi√£o da qualidade em ambientes est√°veis. Excelente em laborat√≥rios, controle de qualidade ou suporte t√©cnico, onde sua paci√™ncia e precis√£o garantem excel√™ncia. Seu desafio √© lidar com ambiguidades; defina processos claros para reduzir incertezas. Seu superpoder √© manter padr√µes elevados com consist√™ncia e apoio √† equipe.`
      };
      return combos[primary + secondary] || "Combina√ß√£o √∫nica que equilibra for√ßas complementares.";
    }

    function showResult() {
      if (responses.some(r => r === null)) {
        alert('Responda todas as perguntas.');
        return;
      }

      // ‚úÖ C√ÅLCULO PRECISO (0% a 100%)
      let D = 0, I = 0, S = 0, C = 0;
      for (let i = 0; i < 48; i++) {
        const resposta = responses[i];
        if (i % 4 === 0) D += resposta; // D: 0,4,8,...
        else if (i % 4 === 1) I += resposta; // I: 1,5,9,...
        else if (i % 4 === 2) S += resposta; // S: 2,6,10,...
        else if (i % 4 === 3) C += resposta; // C: 3,7,11,...
      }

      // Normaliza para 0%‚Äì100%
      const normalize = (score) => {
        const min = 12; // 12 √ó 1
        const max = 60; // 12 √ó 5
        return Math.max(0, Math.min(100, parseFloat((((score - min) / (max - min)) * 100).toFixed(1))));
      };

      const pct = {
        D: normalize(D),
        I: normalize(I),
        S: normalize(S),
        C: normalize(C)
      };

      document.getElementById('test-section').classList.add('hidden');
      document.getElementById('result').classList.remove('hidden');

      const maxWidth = 400;
      setTimeout(() => {
        const setBar = (id, pctVal, color) => {
          const bar = document.getElementById(id);
          bar.style.width = `${(pctVal / 100) * maxWidth}px`;
          bar.style.background = color;
          document.getElementById(`val-${id.split('-')[1]}`).textContent = `${pctVal}%`;
        };
        setBar('bar-dominancia', pct.D, 'linear-gradient(135deg, #ef4444, #b91c1c)');
        setBar('bar-influencia', pct.I, 'linear-gradient(135deg, #f59e0b, #b45309)');
        setBar('bar-estabilidade', pct.S, 'linear-gradient(135deg, #3b82f6, #1e40af)');
        setBar('bar-conformidade', pct.C, 'linear-gradient(135deg, #10b981, #047857)');
      }, 300);

      const sorted = Object.entries(pct).sort((a, b) => b[1] - a[1]);
      const primary = sorted[0][0];
      const secondary = sorted[1][0];

      const p = fullProfiles[primary];
      const s = fullProfiles[secondary];

      document.getElementById('personal-data').innerHTML = 
        `Nome: ${sanitize(document.getElementById('name').value.trim())} | ` +
        `Idade: ${sanitize(document.getElementById('age').value.trim())} | ` +
        `Profiss√£o: ${sanitize(document.getElementById('occupation').value.trim())} | ` +
        `Email: ${sanitize(document.getElementById('email').value.trim())}`;

      document.getElementById('dominant-section').innerHTML = `
        <div class="bg-gradient-to-r from-red-50 to-red-100 p-3 rounded-lg border-l-4 border-red-500">
          <h3 class="text-lg font-bold text-gray-800">Perfil Prim√°rio: ${p.name} (${pct[primary]}%)</h3>
          <p class="mt-1 text-xs"><strong>Descri√ß√£o:</strong> ${p.desc}</p>
          <p class="mt-1 text-xs"><strong>Qualidades:</strong> ${p.qualities}</p>
          <p class="mt-1 text-xs"><strong>Fraquezas:</strong> ${p.weaknesses}</p>
          <p class="mt-1 text-xs"><strong>Para Desenvolver:</strong> ${p.development}</p>
          <p class="mt-2 font-semibold text-xs">Profiss√µes Ideais (20):</p>
          <ul class="list-disc list-inside text-xs mt-1">${professions[primary].map(job => `<li>${job}</li>`).join('')}</ul>
        </div>
        <div class="bg-gradient-to-r from-orange-50 to-orange-100 p-3 rounded-lg border-l-4 border-orange-500">
          <h3 class="text-lg font-bold text-gray-800">Perfil Secund√°rio: ${s.name} (${pct[secondary]}%)</h3>
          <p class="mt-1 text-xs"><strong>Descri√ß√£o:</strong> ${s.desc}</p>
          <p class="mt-1 text-xs"><strong>Qualidades:</strong> ${s.qualities}</p>
          <p class="mt-1 text-xs"><strong>Fraquezas:</strong> ${s.weaknesses}</p>
          <p class="mt-1 text-xs"><strong>Para Desenvolver:</strong> ${s.development}</p>
          <p class="mt-2 font-semibold text-xs">Profiss√µes Ideais (20):</p>
          <ul class="list-disc list-inside text-xs mt-1">${professions[secondary].map(job => `<li>${job}</li>`).join('')}</ul>
        </div>
      `;

      window.userData = {
        name: document.getElementById('name').value.trim(),
        age: document.getElementById('age').value.trim(),
        occupation: document.getElementById('occupation').value.trim(),
        email: document.getElementById('email').value.trim(),
        pct,
        primary,
        secondary,
        p,
        s,
        professions,
        discExplanation: discExplanationFull
      };

      setTimeout(generateAndSendAll, 1500);
    }

    async function generateAndSendAll() {
      const data = window.userData;
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ orientation: 'portrait', unit: 'mm', format: 'a4' });
      const pageWidth = 210;
      let y = 10;

      // === P√ÅGINA 1: CAPA + GR√ÅFICO CENTRALIZADO ===
      doc.setFillColor(6, 182, 212);
      doc.rect(0, 0, pageWidth, 40, 'F');
      doc.setFont('helvetica', 'bold');
      doc.setFontSize(22);
      doc.setTextColor(255, 255, 255);
      doc.text('Pesquisa Impulso DISC', pageWidth / 2, 20, { align: 'center' });
      doc.setFontSize(14);
      doc.text('Relat√≥rio Individual', pageWidth / 2, 30, { align: 'center' });
      y = 50;
      doc.setTextColor(0, 0, 0);
      doc.setFontSize(12);
      doc.text(`Nome: ${sanitize(data.name)}`, 20, y);
      doc.text(`Data: ${new Date().toLocaleDateString('pt-BR')}`, pageWidth - 20, y, { align: 'right' });
      y += 8;
      doc.text(`Idade: ${sanitize(data.age)} | Profiss√£o: ${sanitize(data.occupation)} | Email: ${sanitize(data.email)}`, 20, y, { maxWidth: 170 });
      y += 15;

      const barHeight = 16;
      const barLength = 170; // Largura ajustada para centraliza√ß√£o
      const marginLeft = (pageWidth - 40 - barLength) / 2 + 20; // Margem esquerda calculada
      const colors = { D: [239, 68, 68], I: [245, 158, 11], S: [59, 130, 246], C: [16, 185, 129] };
      const labels = { D: "Domin√¢ncia (D)", I: "Influ√™ncia (I)", S: "Estabilidade (S)", C: "Conformidade (C)" };

      doc.setFontSize(12);
      doc.text('üìä Resultado DISC (%)', 20, y);
      y += 12;

      ['D', 'I', 'S', 'C'].forEach((key, idx) => {
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...colors[key]);
        doc.text(labels[key], 20, y);
        doc.setTextColor(0, 0, 0);
        doc.setFont('helvetica', 'normal');
        doc.text(`${data.pct[key]}%`, pageWidth - 20, y, { align: 'right' });
        doc.setFillColor(...colors[key]);
        doc.rect(marginLeft, y + 3, (data.pct[key] / 100) * barLength, barHeight, 'F');
        doc.setDrawColor(200, 200, 200);
        doc.rect(marginLeft, y + 3, barLength, barHeight, 'S');
        y += barHeight + 12;
      });

      // === P√ÅGINAS 2‚Äì3: PERFIS ===
      const profiles = [
        { key: data.primary, title: "üîù Perfil Prim√°rio", color: data.p.color },
        { key: data.secondary, title: "üîó Perfil Secund√°rio", color: data.s.color }
      ];

      profiles.forEach((profile, idx) => {
        if (idx > 0) doc.addPage();
        y = 20;
        const info = fullProfiles[profile.key];
        doc.setFillColor(248, 248, 248);
        doc.rect(10, 10, 190, 275, 'F');
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(14);
        const colorMap = { "#ef4444": [185, 28, 28], "#f59e0b": [194, 65, 12], "#3b82f6": [30, 64, 175], "#10b981": [13, 148, 136] };
        doc.setTextColor(...(colorMap[profile.color] || [0, 0, 0]));
        doc.text(`${profile.title}: ${info.name} (${data.pct[profile.key]}%)`, 20, y);
        y += 12;
        doc.setTextColor(0, 0, 0);
        doc.setFontSize(9);
        doc.text(`Descri√ß√£o:`, 20, y); y += 5;
        doc.setFontSize(8);
        doc.text(info.desc, 25, y, { maxWidth: 165, lineHeightFactor: 1.4 }); y += 25;
        doc.text(`Qualidades:`, 20, y); y += 5;
        doc.text(info.qualities, 25, y, { maxWidth: 165, lineHeightFactor: 1.4 }); y += 20;
        doc.text(`Fraquezas:`, 20, y); y += 5;
        doc.text(info.weaknesses, 25, y, { maxWidth: 165, lineHeightFactor: 1.4 }); y += 25;
        doc.text(`Para Desenvolver:`, 20, y); y += 5;
        doc.text(info.development, 25, y, { maxWidth: 165, lineHeightFactor: 1.4 }); y += 15;
        doc.setFontSize(10);
        doc.text('Profiss√µes Ideais (20):', 20, y); y += 8;
        doc.setFontSize(8);
        data.professions[profile.key].forEach((job, j) => {
          doc.text(`${j + 1}. ${job}`, 25, y);
          y += 5;
        });
      });

      // === P√ÅGINA 4: EXPLICA√á√ÉO DO DISC ===
      doc.addPage();
      y = 20;
      doc.setFont('helvetica', 'bold');
      doc.setFontSize(14);
      doc.setTextColor(30, 64, 175);
      doc.text('‚ÑπÔ∏è O que √© o DISC?', 20, y);
      y += 10;
      doc.setTextColor(0, 0, 0);
      doc.setFontSize(9);
      doc.text(data.discExplanation, 20, y, { maxWidth: 170, lineHeightFactor: 1.4 });

      // === P√ÅGINA 5: COMBINA√á√ÉO ===
      doc.addPage();
      y = 20;
      doc.setFont('helvetica', 'bold');
      doc.setFontSize(14);
      doc.setTextColor(30, 64, 175);
      doc.text(`üîÑ Combina√ß√£o: ${data.p.name} + ${data.s.name}`, 20, y);
      y += 10;
      doc.setTextColor(0, 0, 0);
      doc.setFontSize(9);
      doc.text(getCombinationExplanation(data.primary, data.secondary), 20, y, { maxWidth: 170, lineHeightFactor: 1.4 });

      doc.setFontSize(9);
      doc.setFont('helvetica', 'italic');
      doc.setTextColor(30, 64, 175);
      doc.text('Relat√≥rio gerado por Impulso Coaching ‚Ä¢ impulsoflow@gmail.com', pageWidth / 2, 285, { align: 'center' });

      const pdfName = `resultado_disc_${data.name.replace(/\s+/g, '_')}.pdf`;
      doc.save(pdfName);

      // === SALVAR HTML ===
      const fullHtml = `
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>Resultado DISC - ${sanitize(data.name)}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; background: #f9fafb; }
            .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
          </style>
        </head>
        <body>
          <div class="container">
            ${document.getElementById('result').innerHTML}
          </div>
        </body>
        </html>
      `;
      const htmlBlob = new Blob([fullHtml], { type: 'text/html' });
      const htmlUrl = URL.createObjectURL(htmlBlob);
      const htmlLink = document.createElement('a');
      htmlLink.href = htmlUrl;
      htmlLink.download = `resultado_disc_${data.name.replace(/\s+/g, '_')}.html`;
      htmlLink.click();
      URL.revokeObjectURL(htmlUrl);

      // ‚úÖ CORRE√á√ÉO: PRINT COMPLETO DA P√ÅGINA
      const resultDiv = document.getElementById('result');
      if (resultDiv) {
        const clone = resultDiv.cloneNode(true);
        clone.style.width = '800px';
        clone.style.position = 'absolute';
        clone.style.top = '-9999px';
        document.body.appendChild(clone);

        html2canvas(clone, {
          scale: 2,
          useCORS: true,
          backgroundColor: null,
          windowWidth: 800,
          windowHeight: clone.scrollHeight
        }).then(canvas => {
          const link = document.createElement('a');
          link.href = canvas.toDataURL('image/png');
          link.download = `resultado_disc_${data.name.replace(/\s+/g, '_')}_tela.png`;
          link.click();
        }).catch(err => {
          console.error('Erro ao capturar tela:', err);
        }).finally(() => {
          document.body.removeChild(clone);
        });
      }

      // ‚úÖ CORRE√á√ÉO: ENVIO AUTOM√ÅTICO COM TEMPLATE V√ÅLIDO
      const emailContent = `
${data.discExplanation}

========================================
RESULTADO COMPLETO DA PESQUISA DISC
========================================

Nome: ${data.name}
Idade: ${data.age}
Profiss√£o: ${data.occupation}
Email: ${data.email}
Data: ${new Date().toLocaleDateString('pt-BR')}

Resultados DISC:
- Domin√¢ncia: ${data.pct.D}%
- Influ√™ncia: ${data.pct.I}%
- Estabilidade: ${data.pct.S}%
- Conformidade: ${data.pct.C}%

Perfil Prim√°rio: ${data.p.name} (${data.pct[data.primary]}%)
Descri√ß√£o: ${data.p.desc}
Qualidades: ${data.p.qualities}
Fraquezas: ${data.p.weaknesses}
Para Desenvolver: ${data.p.development}
Profiss√µes Ideais:
${data.professions[data.primary].map((job, i) => `${i + 1}. ${job}`).join('\n')}

Perfil Secund√°rio: ${data.s.name} (${data.pct[data.secondary]}%)
Descri√ß√£o: ${data.s.desc}
Qualidades: ${data.s.qualities}
Fraquezas: ${data.s.weaknesses}
Para Desenvolver: ${data.s.development}
Profiss√µes Ideais:
${data.professions[data.secondary].map((job, i) => `${i + 1}. ${job}`).join('\n')}

Combina√ß√£o dos Perfis:
${getCombinationExplanation(data.primary, data.secondary)}
`;

      // Envio corrigido
      const templateParams = {
        message: emailContent.replace(/\n/g, '<br>'),
        from_name: data.name,
        from_email: data.email,
      };

      try {
        await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, templateParams);
        console.log("E-mail enviado com sucesso!");
      } catch (err) {
        console.error("Erro no envio:", err);
        alert("‚ö†Ô∏è Falha no envio.\n\nCopie os dados abaixo:\n\n" + emailContent);
      }

      alert(`‚úÖ Resultado salvo!\n- PDF: ${pdfName}\n- Imagem: *_tela.png\n- HTML: *.html\nüìß E-mail enviado para impulsoflow@gmail.com.`);
    }
  </script>
</body>
</html>
